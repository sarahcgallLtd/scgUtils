<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Retrieve and Process File from Various Sources — get_file • scgUtils</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Retrieve and Process File from Various Sources — get_file"><meta name="description" content="get_file retrieves and preprocesses a file from different sources, including
local storage, OneDrive, and the web. It supports multiple file formats such as
CSV, Excel (XLSX and XLS), SPSS (SAV), and ZIP archives containing these file types.
The function applies preprocessing based on the file type and, for ZIP files, processes
and combines data from supported files within the archive."><meta property="og:description" content="get_file retrieves and preprocesses a file from different sources, including
local storage, OneDrive, and the web. It supports multiple file formats such as
CSV, Excel (XLSX and XLS), SPSS (SAV), and ZIP archives containing these file types.
The function applies preprocessing based on the file type and, for ZIP files, processes
and combines data from supported files within the archive."><meta property="og:image" content="https://docs.sarahcgall.co.uk/scgUtils/logo.png"></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scgUtils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/using-survey-data.html">Using scgUtils with Survey Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Function Explainers</h6></li>
    <li><a class="dropdown-item" href="../articles/uploading-data.html">Uploading &amp; Cleaning Data</a></li>
    <li><a class="dropdown-item" href="../articles/weight-your-data.html">Weighting Your Data</a></li>
    <li><a class="dropdown-item" href="../articles/crosstabs.html">Conducting Cross-Tabulation Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/creating-colour-palettes.html">Mastering Colour Selection</a></li>
    <li><a class="dropdown-item" href="../articles/visualising-data.html">Visualising Data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sarahcgall/scgUtils/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Retrieve and Process File from Various Sources</h1>
      <small class="dont-index">Source: <a href="https://github.com/sarahcgall/scgUtils/blob/master/R/get_file.R" class="external-link"><code>R/get_file.R</code></a></small>
      <div class="d-none name"><code>get_file.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>get_file</code> retrieves and preprocesses a file from different sources, including
local storage, OneDrive, and the web. It supports multiple file formats such as
CSV, Excel (XLSX and XLS), SPSS (SAV), and ZIP archives containing these file types.
The function applies preprocessing based on the file type and, for ZIP files, processes
and combines data from supported files within the archive.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_file</span><span class="op">(</span></span>
<span>  <span class="va">file_path</span>,</span>
<span>  source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"local"</span>, <span class="st">"onedrive"</span>, <span class="st">"web"</span><span class="op">)</span>,</span>
<span>  row_no <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sheet_no <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  file_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_name <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-file-path">file_path<a class="anchor" aria-label="anchor" href="#arg-file-path"></a></dt>
<dd><p>The path, ID, or URL of the file to be retrieved.</p></dd>


<dt id="arg-source">source<a class="anchor" aria-label="anchor" href="#arg-source"></a></dt>
<dd><p>The source of the file: 'local', 'onedrive', or 'web'
(default is 'local').</p></dd>


<dt id="arg-row-no">row_no<a class="anchor" aria-label="anchor" href="#arg-row-no"></a></dt>
<dd><p>The number of rows to skip at the beginning of the file, applicable
for CSV and Excel files (default is 0).</p></dd>


<dt id="arg-sheet-no">sheet_no<a class="anchor" aria-label="anchor" href="#arg-sheet-no"></a></dt>
<dd><p>The sheet number to read from Excel files (XLSX or XLS), where
1 is the first sheet (default is 1, which will read the first sheet). Ignored
for non-Excel files.</p></dd>


<dt id="arg-file-name">file_name<a class="anchor" aria-label="anchor" href="#arg-file-name"></a></dt>
<dd><p>Optional; for ZIP files, the name of a specific file within the archive
to process. If <code>NULL</code>, all supported files in the ZIP are processed (default is <code>NULL</code>).</p></dd>


<dt id="arg-add-name">add_name<a class="anchor" aria-label="anchor" href="#arg-add-name"></a></dt>
<dd><p>Optional; for ZIP files. If <code>TRUE</code>, the file name of the unzipped file will be added in
a column called "file_name" within the processed data frame (default is <code>FALSE</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame containing the contents of the file after preprocessing.
For ZIP files, it returns a combined data frame from all processed files, with an
additional column <code>'file_name'</code> indicating the source file within the archive.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function determines the file type from its extension (e.g., 'csv', 'xls', 'xlsx', 'sav', 'zip'),
retrieves the file from the specified source using <code>authenticate_source</code>, and preprocesses
it with <code>preprocess_file_type</code>. Supported file types are handled as follows:</p><ul><li><p><strong>CSV</strong>: Reads the file with automatic delimiter detection, skips the specified number
of rows, and converts all columns to character initially before auto-detecting types.
Special characters are removed from text columns.</p></li>
<li><p><strong>Excel (XLSX and XLS)</strong>: Reads the specified sheet (via <code>sheet_no</code>), skips the specified
number of rows, and processes columns similarly to CSV files.</p></li>
<li><p><strong>SAV (SPSS)</strong>: Reads the file, attempting default encoding first and falling back to
'latin1' if needed. It removes labels and processes factors for cleaner output.</p></li>
<li><p><strong>ZIP</strong>: Extracts supported files (CSV, XLS, XLSX, SAV) from the archive into a unique
temporary directory, processes them, and combines the data into a single data frame with
an additional <code>'file_name'</code> column. If <code>file_name</code> is specified, only that file is processed.</p></li>
</ul><p>If the file type is not supported, an error is thrown.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="co"># Retrieve a local CSV file</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">get_file</span><span class="op">(</span><span class="st">"path/to/local/file.csv"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Retrieve a local Excel file, reading the second sheet</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">get_file</span><span class="op">(</span><span class="st">"path/to/local/file.xlsx"</span>, sheet_no <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Retrieve a file from OneDrive</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">get_file</span><span class="op">(</span><span class="st">"file-id"</span>, source <span class="op">=</span> <span class="st">"onedrive"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Retrieve and preprocess a Google Drive file, skipping the first row</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">get_file</span><span class="op">(</span><span class="st">"file-id"</span>, source <span class="op">=</span> <span class="st">"googledrive"</span>, row_no <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Retrieve a file from the web, skipping the first row</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">get_file</span><span class="op">(</span><span class="st">"https://example.com/data.csv"</span>, source <span class="op">=</span> <span class="st">"web"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Retrieve and process all supported files from a local ZIP archive</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">get_file</span><span class="op">(</span><span class="st">"path/to/local/archive.zip"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Retrieve and process a specific file from a ZIP archive</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">get_file</span><span class="op">(</span><span class="st">"path/to/local/archive.zip"</span>, file_name <span class="op">=</span> <span class="st">"specific_file.csv"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.sarahcgall.co.uk/" class="external-link">Sarah Gall</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer></body></html>

